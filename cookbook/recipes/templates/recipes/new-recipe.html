{% extends 'recipes/recipes-base.html' %}
{% block title %}Recipes - New Item{% endblock %}

{% block navbar %}
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Recipes</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="{% url 'recipes-home' %}">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="#">New Item</a>
            </li>
              <li class="nav-item">
              <a class="nav-link" href="{% url 'cookbook' %}">Cookbook</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
{% endblock %}

{% block content %}
<h1>Add new item to Cookbook</h1>
<form method="post">
    {% csrf_token %}
    <div class="form-section">
        <h4 class="border-bottom mb-4">Recipe</h4>
        {{ recipe_form.as_p }}
    </div>
    <div class="form-section">
        <h4 class="border-bottom mb-4">Ingredient Groups</h4>
        {{ ingredient_group_formset.management_form }}

        <!--For displaying errors if any-->
        {% if ingredient_groups_formset.non_form_errors %}
        <div class="alert alert-danger">
            {{ ingredient_groups_formset.non_form_errors }}
        </div>
        {% endif %}

        <!-- The container for the ingredient groups -->
        <div id="formset-container">
            {% for form in ingredient_group_formset %}
            <div class="formset-row" data-form-index="{{ forloop.counter0 }}">
                <div class="row">
                    <!-- The hidden fields for each group (ID and DELETE) -->
                    {% for hidden in form.hidden_fields %}
                        {{ hidden }}
                    {% endfor %}
                    <div class="col">
                        <label class="form-label">Group Name</label>
                        {{ form.name }}
                    </div>
                    <div class="col">
                        <div class="delete-checkbox">
                            {{ form.DELETE }}
                            <label for="{{ form.DELETE.id_for_label }}" class="form-label text-danger">
                                Delete Group
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <button type="submit" class="btn btn-primary">Submit</button>
    <a href="{% url 'recipes-home' %}" class="btn btn-secondary">Cancel</a>
</form>
{% endblock %}
